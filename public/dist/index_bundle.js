(()=>{"use strict";var e={607:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{l(s.next(e))}catch(e){n(e)}}function r(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((s=s.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.player=void 0;const n=i(768),o=i(363),r=i(692),l=i(630),d=a(i(10)),c=i(177),h=i(635),p=i(495),u=i(221),y=i(619),f=i(9),g=i(839),v=document.getElementById("canvas"),m=document.getElementById("fog"),b=window.devicePixelRatio;document.body,v.style.width=`${window.innerWidth}px`,v.style.height=`${window.innerHeight}px`,v.width=window.innerWidth*b,v.height=window.innerHeight*b,m.style.width="1920px",m.style.height="1080px",m.width=1920*b,m.height=1080*b,t.player=new o.Player("tester"),new l.Opponent("loti");const x="leather";t.player.addToDeck(new n.Card(Object.assign({uid:t.player.deck.size},h.fish),x)),t.player.addToDeck(new n.Card(Object.assign({uid:t.player.deck.size},h.fish),x)),t.player.addToDeck(new n.Card(Object.assign({uid:t.player.deck.size},h.fish),x)),t.player.addToDeck(new n.Card(Object.assign({uid:t.player.deck.size},h.fish),x)),t.player.addToDeck(new n.Card(Object.assign({uid:t.player.deck.size},c.bird),x)),t.player.addToDeck(new n.Card(Object.assign({uid:t.player.deck.size},p.shark),x));d.default.loadAll(["../public/assets/card-zone.png","../public/assets/part/abilities/double-attack.png"].concat(["../public/assets/card/default/front.png","../public/assets/card/default/back.png","../public/assets/card/default/backx6.png","../public/assets/card/default/backx5.png","../public/assets/card/default/frontx3.png","../public/assets/card/leather/front.png","../public/assets/card/leather/back.png","../public/assets/card/leather/frontx3.png","../public/assets/card/leather/backx3.png"],["../public/assets/part/type/default/1.png","../public/assets/part/type/default/2.png","../public/assets/part/type/default/3.png","../public/assets/part/type/default/1x3.png","../public/assets/part/type/default/2x3.png","../public/assets/part/type/default/3x3.png","../public/assets/part/type/leather/1.png","../public/assets/part/type/leather/2.png","../public/assets/part/type/leather/3.png","../public/assets/part/type/leather/1x3.png","../public/assets/part/type/leather/2x3.png","../public/assets/part/type/leather/3x3.png"],["../public/assets/monster/default/human.png","../public/assets/monster/default/bird.png","../public/assets/monster/default/turtle.png","../public/assets/monster/default/forestGuardian.png","../public/assets/monster/default/shark.png","../public/assets/monster/default/fish.png","../public/assets/monster/leather/bird.png","../public/assets/monster/leather/birdx3.png","../public/assets/monster/leather/fish.png","../public/assets/monster/leather/fishx3.png","../public/assets/monster/leather/shark.png","../public/assets/monster/leather/sharkx3.png"],["../public/assets/part/sacrifice/0.png","../public/assets/part/sacrifice/1.png","../public/assets/part/sacrifice/2.png","../public/assets/part/sacrifice/3.png","../public/assets/part/sacrifice/0x3.png","../public/assets/part/sacrifice/1x3.png","../public/assets/part/sacrifice/2x3.png","../public/assets/part/sacrifice/3x3.png"],["../public/assets/part/number/0.png","../public/assets/part/number/1.png","../public/assets/part/number/2.png","../public/assets/part/number/3.png","../public/assets/part/number/4.png","../public/assets/part/number/5.png","../public/assets/part/number/6.png","../public/assets/part/number/7.png","../public/assets/part/number/8.png","../public/assets/part/number/9.png","../public/assets/part/number/0x3.png","../public/assets/part/number/1x3.png","../public/assets/part/number/2x3.png","../public/assets/part/number/3x3.png","../public/assets/part/number/4x3.png","../public/assets/part/number/5x3.png","../public/assets/part/number/6x3.png","../public/assets/part/number/7x3.png","../public/assets/part/number/8x3.png","../public/assets/part/number/9x3.png"],["../public/assets/bell/wooden_bell.png"],["../public/assets/world/entity/player/back.png","../public/assets/world/entity/player/front.png","../public/assets/world/entity/player/left.png","../public/assets/world/entity/player/right.png","../public/assets/world/entity/shadow/shadow.png","../public/assets/world/entity/nurse/front.png","../public/assets/world/entity/bed/front.png","../public/assets/world/entity/walls/wall.png","../public/assets/world/entity/etc/E.png"],["../public/assets/subtitle/subtitle.png","../public/assets/subtitle/subtitleX6.png","../public/assets/subtitle/profiles/nurseX6.png","../public/assets/subtitle/profiles/playerX6.png"],["../public/assets/world/tiles/grass.png","../public/assets/world/tiles/water.png"],["../public/assets/playerUI/wooden/X5.png","../public/assets/playerUI/wooden/behaviorPointBar.png","../public/assets/playerUI/card_info/wooden.png","../public/assets/playerUI/card_info/health.png","../public/assets/playerUI/card_info/atkDef.png","../public/assets/playerUI/behaviorPoint/wooden.png","../public/assets/background/1.jpg"])).then((()=>s(void 0,void 0,void 0,(function*(){y.ArcFade.init(),g.OpacityFade.init(),u.World.init();const e=new l.Opponent("loti");f.CardGameEngine.newGame(new r.Game("test",5,{player:t.player,opponent:e})),f.CardGameEngine.select("test"),f.CardGameEngine.start()}))))},628:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{l(s.next(e))}catch(e){n(e)}}function r(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((s=s.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CardGameUI=void 0;const n=i(101),o=i(153),r=a(i(10)),l=i(826),d=document.getElementById("canvas").getContext("2d"),c=document.body,h=window.devicePixelRatio,p=375,u=156,y=260,f={x:0,y:0};let g={left:!1,right:!1};const v=new o.CanvasObject("../public/assets/bell/wooden_bell.png",{x:c.getBoundingClientRect().width*h-92-50,y:c.getBoundingClientRect().height*h-p-300+16}),m=[v,new o.CanvasObject("../public/assets/playerUI/wooden/X5.png",{x:15*h,y:c.getBoundingClientRect().height*h-p}),new o.CanvasObject("../public/assets/playerUI/wooden/X5.png",{x:c.getBoundingClientRect().width*h-300,y:c.getBoundingClientRect().height*h-p}),new o.CanvasObject("../public/assets/playerUI/wooden/behaviorPointBar.png",{x:1040,y:c.getBoundingClientRect().height*h-p-108+18})];let b={isOn:!1,moveCount:1};const x=e=>f.x>=e.x/h&&f.x<(e.x+e.w)/h&&f.y>=e.y/h&&f.y<(e.y+e.h)/h;class w{static init(e){return s(this,void 0,void 0,(function*(){this.selectedGame=e,m.forEach((e=>{this.objects.set(this.objects.size,e)})),this.selectedGame.player.deck.forEach(((e,t)=>{const i=new o.CanvasObject(`../public/assets/card/${e.theme}/back.png`,{x:c.getBoundingClientRect().width*h-300+72-2*t,y:c.getBoundingClientRect().height*h-p+57.5-2*t});this.deck.canvasObj.set(this.deck.canvasObj.size,i)}));for(let e=0;e<this.selectedGame.behaviorPoint.player;e++){const t=new o.CanvasObject("../public/assets/playerUI/behaviorPoint/wooden.png",{x:1068+30*e,y:c.getBoundingClientRect().height*h-p-108+24+18});this.behaviorObj.canvasObj.set(this.behaviorObj.canvasObj.size,t)}for(let e=0;e<4;e++)for(let t=0;t<3;t++){const i=new o.CanvasObject("../public/assets/background/1.jpg",{x:600*e,y:600*t-600});this.backgorund.canvasObj.set(this.backgorund.canvasObj.size,i)}window.addEventListener("mousemove",(e=>{f.x=e.clientX,f.y=e.clientY})),window.addEventListener("mouseup",(e=>{0===e.button?g.left=!0:2===e.button&&(g.right=!0)}));for(let e=0;e<3;e++)yield(0,l.Wait)(.3),this.drawCard()}))}static load(){this.selectedGame&&(this.lookModeAnimate(),this.backgorund.canvasObj.forEach((e=>{e.load()})),this.objects.forEach((e=>{e.load()})),this.deck.canvasObj.forEach((e=>{e.load()})),this.hand.canvasObj.forEach((e=>{e.load()})),this.behaviorObj.canvasObj.forEach((e=>{e.load()})),this.lookMode.isOn||(this.drawAnimate(),this.overAnimate(),this.handUpdateKey>=0&&this.updateHand(this.handUpdateKey)),this.summonAnimate(),this.mouseOverBellAnimate(),this.hitTheBell(),this.hitTheBellAnimate(),this.showInfo(),g.left=!1,g.right=!1)}static lookModeAnimate(){const e=15;this.selectedGame.field.isLookField?this.lookMode.isOn&&(this.lookMode.cv>=p?(this.lookMode.isOn=!1,this.objects.forEach((e=>{e.save()})),this.hand.canvasObj.forEach((e=>{e.save()})),this.deck.canvasObj.forEach((e=>{e.save()})),this.behaviorObj.canvasObj.forEach((e=>{e.save()})),this.backgorund.canvasObj.forEach((e=>{e.save()}))):(this.lookMode.isOn=!0,this.objects.forEach((t=>{t.moveTo(t.savedPos.x,t.savedPos.y+p,e)})),this.hand.canvasObj.forEach((t=>{t.moveTo(t.savedPos.x,t.savedPos.y+p,e)})),this.deck.canvasObj.forEach((t=>{t.moveTo(t.savedPos.x,t.savedPos.y+p,e)})),this.behaviorObj.canvasObj.forEach((t=>{t.moveTo(t.savedPos.x,t.savedPos.y+p,e)})),this.backgorund.canvasObj.forEach((t=>{t.moveTo(t.savedPos.x,t.savedPos.y+p,e)})),this.lookMode.cv+=e)):this.lookMode.isOn&&(this.lookMode.cv<=0?(this.lookMode.isOn=!1,this.objects.forEach((e=>{e.save()})),this.hand.canvasObj.forEach((e=>{e.save()})),this.deck.canvasObj.forEach((e=>{e.save()})),this.behaviorObj.canvasObj.forEach((e=>{e.save()})),this.backgorund.canvasObj.forEach((e=>{e.save()}))):(this.lookMode.isOn=!0,this.objects.forEach((t=>{t.moveTo(t.savedPos.x,t.savedPos.y-p,e)})),this.hand.canvasObj.forEach((t=>{t.moveTo(t.savedPos.x,t.savedPos.y-p,e)})),this.deck.canvasObj.forEach((t=>{t.moveTo(t.savedPos.x,t.savedPos.y-p,e)})),this.behaviorObj.canvasObj.forEach((t=>{t.moveTo(t.savedPos.x,t.savedPos.y-p,e)})),this.backgorund.canvasObj.forEach((t=>{t.moveTo(t.savedPos.x,t.savedPos.y-p,e)})),this.lookMode.cv-=e))}static showInfo(){if(g.left&&(this.selectedCard=void 0),this.selectedGame.field.fieldAxis.opponent.forEach(((e,t)=>{x({x:e.x,y:e.y,w:234,h:390})&&g.right&&(this.selectedCard=this.selectedGame.field.fieldArrange.opponent[t])})),this.selectedGame.field.fieldAxis.player.forEach(((e,t)=>{x({x:e.x,y:e.y,w:234,h:390})&&g.right&&(this.selectedCard=this.selectedGame.field.fieldArrange.player[t])})),this.selectedCard){const e=26,t=(c.getBoundingClientRect().height*h-p-520)/2+70;d.drawImage(r.default.get("../public/assets/playerUI/card_info/wooden.png"),24,(c.getBoundingClientRect().height*h-p-520)/2),d.drawImage(r.default.get("../public/assets/playerUI/card_info/health.png"),24+e,t),d.drawImage(r.default.get(`../public/assets/monster/${this.selectedCard.theme}/${this.selectedCard.id}.png`),24+e+156,t),d.drawImage(r.default.get("../public/assets/playerUI/card_info/atkDef.png"),24+e+312,t),d.font="bold 20px Arial",d.fillText(this.selectedCard.abilities.active.name,24+e,2*t),d.fillText(this.selectedCard.abilities.active.desc,24+e,2*t+30)}}static addToHand(e){this.selectedGame.player.hand.set(e.uid,e)}static hitTheBell(){this.selectedGame.isPlayerTurn&&g.left&&f.x>=v.savedPos.x/h&&f.x<(v.savedPos.x+92)/h&&f.y>=v.savedPos.y/h&&f.y<(v.savedPos.y+300)/h&&(this.selectedGame.isPlayerTurn=!1,this.selectedGame.countOfTurn+=1,b.isOn=!0)}static hitTheBellAnimate(){b.isOn&&(4===b.moveCount?(v.moveTo(v.savedPos.x,v.savedPos.y,2),v.x===v.savedPos.x&&(b.isOn=!1,b.moveCount=1)):(b.moveCount%2==0?v.moveTo(v.savedPos.x-10,v.savedPos.y-20,2):v.moveTo(v.savedPos.x+10,v.savedPos.y-20,2),v.x!==v.savedPos.x-10&&v.x!==v.savedPos.x+10||(b.moveCount+=1)))}static mouseOverBellAnimate(){b.isOn||this.lookMode.isOn||(this.selectedGame.isPlayerTurn&&f.x>=v.savedPos.x/h&&f.x<(v.savedPos.x+92)/h&&f.y>=v.savedPos.y/h&&f.y<(v.savedPos.y+300)/h?v.moveTo(v.savedPos.x,v.savedPos.y-20,10):v.moveTo(v.savedPos.x,v.savedPos.y,10))}static summon(e){return s(this,void 0,void 0,(function*(){this.selectedGame.field.isLookField=!0,this.lookMode.isOn=!0,this.selectedGame.field.selectCard(e,this.selectedGame.isPlayerTurn),this.selectedGame.behaviorPoint.player-=1}))}static summonAnimate(){if(this.selectedGame.behaviorPoint.player>0&&!this.playerBehaviorState.isDrawing){const e=[];this.hand.canvasObj.forEach(((t,i)=>{e.push({key:i,value:t})})),e.reverse().forEach((e=>{const t=this.hand.card.get(e.key);if(g.left&&f.x>=e.value.x/h&&f.x<(e.value.x+u)/h&&f.y>=e.value.y/h&&f.y<(e.value.y+y)/h&&this.hand.canvasObj.has(e.key)){const i={total:this.selectedGame.field.numOfCardOnField().player.total>=t.sacrifice.length,type1:this.selectedGame.field.numOfCardOnField().player.types[1]>=t.sacrifice.filter((e=>1===e)).length,type2:this.selectedGame.field.numOfCardOnField().player.types[2]>=t.sacrifice.filter((e=>2===e)).length,type3:this.selectedGame.field.numOfCardOnField().player.types[3]>=t.sacrifice.filter((e=>3===e)).length};i.total&&i.type1&&i.type2&&i.type3&&(this.selectedGame.field.selectedCard||(this.summon(this.hand.card.get(e.key)),this.hand.canvasObj.delete(e.key),this.hand.card.delete(e.key),this.handUpdateKey=e.key))}}))}}static overAnimate(){const e=[];this.hand.canvasObj.forEach((t=>{e.push(t)}));const t=e.reverse().filter((e=>f.x>=e.x/h&&f.x<(e.x+u)/h&&f.y>=e.y/h&&f.y<(e.y+y)/h)),i=e.reverse().filter((e=>!(f.x>=e.x/h&&f.x<(e.x+u)/h&&f.y>=e.y/h&&f.y<(e.y+y)/h)));t.length>0&&(t[0].moveTo(t[0].x,t[0].savedPos.y-20,10),t.length>1&&i.push(t[1])),i.forEach((e=>{e.moveTo(e.x,e.savedPos.y,10)}))}static updateHand(e){for(let t=0;t<this.hand.card.size-e+1;t++){const i=this.hand.canvasObj.get(e+1+t);i&&i.moveTo(50+120*(e+t),i.y,30)}}static drawAnimate(){this.selectedGame.player.deck.forEach(((e,t)=>{const i=c.getBoundingClientRect().width*h-300+72-2*t,s=c.getBoundingClientRect().height*h-p+57.5;this.playerBehaviorState.isDrawing||g.left&&f.x>=i/h&&f.x<(i+u)/h&&f.y>=s/h&&f.y<(s+y)/h&&(this.playerBehaviorState.isDrawing=!0,this.drawCard())})),this.drawAnimation.card&&(this.drawAnimation.card.moveTo(this.drawAnimation.to,this.drawAnimation.card.y,100),this.drawAnimation.card.x===this.drawAnimation.to&&(this.drawAnimation.card.save(),this.drawAnimation.card=void 0,this.playerBehaviorState.isDrawing=!1))}static drawCard(){this.currentCardIndex=this.selectedGame.player.deck.size-1;let e=this.selectedGame.player.deck.get(this.currentCardIndex);const t=new n.CanvasCardObject(e,!0,{x:c.getBoundingClientRect().width*h-300+72-2*this.selectedGame.player.deck.size,y:c.getBoundingClientRect().height*h-p+57.5},e.theme);this.drawAnimation.card=t,this.drawAnimation.to=50+120*this.hand.canvasObj.size,this.selectedGame.player.removeToDeck(this.currentCardIndex),this.deck.canvasObj.delete(this.deck.canvasObj.size-1),this.addToHand(e),this.hand.card.set(this.hand.card.size,e),this.hand.canvasObj.set(this.hand.canvasObj.size,t)}}t.CardGameUI=w,w.playerBehaviorState={isDrawing:!1,isSummonning:!1},w.moveCount=0,w.currentCardIndex=0,w.hand={card:new Map,canvasObj:new Map},w.deck={canvasObj:new Map},w.behaviorObj={canvasObj:new Map},w.backgorund={canvasObj:new Map},w.objects=new Map,w.storeCardYAxis=c.getBoundingClientRect().height*h-p+57.5,w.MouseOverCard=void 0,w.drawAnimation={card:void 0,to:0,isDone:!1},w.handUpdateKey=-1,w.lookMode={cv:0,isOn:!1}},692:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;const s=i(670);t.Game=class{constructor(e,t,i){this.countOfTurn=0,this.isPlayerTurn=!0,this.behaviorPoint={player:5,opponent:2},this.gameName=e,this.player=i.player,this.opponent=i.opponent,this.numOfCardZone=t,this.field=new s.Field(this.numOfCardZone)}}},9:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{l(s.next(e))}catch(e){n(e)}}function r(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CardGameEngine=void 0;const a=i(826),n=i(768),o=i(924),r=i(619),l=i(221),d=i(628),c=document.getElementById("canvas").getContext("2d"),h=document.body,p=window.devicePixelRatio;class u{static newGame(e){this.games.set(e.gameName,e),this.select(e.gameName)}static select(e){void 0!==this.selectedGame&&this.selectedGame.gameName===e||(this.isOn?console.error("try after off the Game"):this.games.has(e)&&(this.selectedGame=this.games.get(e)))}static start(){return s(this,void 0,void 0,(function*(){if(this.selectedGame&&!this.isOn){yield l.World.off(),yield(0,a.Wait)(1),this.selectedGame.field.isOn=!0,this.init(),yield r.ArcFade.in(1,.5);for(const[e,t]of this.selectedGame.opponent.deck)this.selectedGame.opponent.addToHand(t)}}))}static end(){return s(this,void 0,void 0,(function*(){this.isOn&&(this.selectedGame.field.isOn=!1,this.selectedGame.field.init(),this.selectedGame.player.initHand())}))}static skillSelect(){}static loop(){c.clearRect(0,0,h.getBoundingClientRect().width*p,h.getBoundingClientRect().height*p),d.CardGameUI.load(),u.selectedGame.field.load(),requestAnimationFrame(u.loop)}static init(){this.selectedGame.field.init(),this.selectedGame.player.initHand(),d.CardGameUI.init(u.selectedGame),this.selectedGame.field.placeCard(new n.Card(Object.assign({uid:14},o.test),"leather"),0,!1),this.selectedGame.field.placeCard(new n.Card(Object.assign({uid:15},o.test),"leather"),1,!1),requestAnimationFrame(u.loop)}}t.CardGameEngine=u,u.isOn=!1,u.games=new Map,u.phase=1},670:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{l(s.next(e))}catch(e){n(e)}}function r(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((s=s.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Field=void 0;const n=i(101),o=a(i(10)),r=i(628),l=document.getElementById("canvas").getContext("2d"),d=document.body,c=window.devicePixelRatio,h="../public/assets/card-zone.png";let p,u;const y=375;t.Field=class{constructor(e){this.isOn=!1,this.isArranging=!1,this.isSacrificing=!1,this.fieldAxis={opponent:[],player:[]},this.save={opponent:[],player:[]},this.fieldArrange={opponent:[],player:[]},this.canvasCardObjects={opponent:new Map,player:new Map},this.selectedSacrificeCard=[],this.isPlayerTurn=!0,this.opacity={value:0,state:!1},this.isLookField=!1,this.isUpdating=!1,this.numOfCardZone=e}renderCard(){this.canvasCardObjects.opponent.forEach((e=>{e.load(),e.rander()})),this.canvasCardObjects.player.forEach((e=>{e.load(),e.rander()}))}selectCard(e,t){return s(this,void 0,void 0,(function*(){this.selectedCard=e,e.sacrifice.length<1?this.isArranging=!0:this.isSacrificing=!0,this.isPlayerTurn=t}))}placeCard(e,t,i){i?this.fieldArrange.player[t]||(this.fieldArrange.player[t]=e,this.canvasCardObjects.player.set(e.uid,new n.CanvasCardObject(e,i,{x:this.fieldAxis.player[t].x,y:this.fieldAxis.player[t].y},e.theme,!0))):this.fieldArrange.opponent[t]||(this.fieldArrange.opponent[t]=e,this.canvasCardObjects.opponent.set(e.uid,new n.CanvasCardObject(e,i,{x:this.fieldAxis.opponent[t].x,y:this.fieldAxis.opponent[t].y},e.theme,!0)))}numOfCardOnField(){let e=[],t=[];return this.fieldArrange.player.map((t=>{t&&e.push(t.type)})),this.fieldArrange.opponent.map((e=>{e&&t.push(e.type)})),{player:{types:{1:e.filter((e=>1===e)).length,2:e.filter((e=>2===e)).length,3:e.filter((e=>3===e)).length},total:e.length},opponent:{types:{1:t.filter((e=>1===e)).length,2:t.filter((e=>2===e)).length,3:t.filter((e=>3===e)).length},total:t.length}}}kill(e,t){0===e?(this.canvasCardObjects.opponent.delete(this.fieldArrange.opponent[t].uid),this.fieldArrange.opponent[t]=void 0):1===e&&(this.canvasCardObjects.player.delete(this.fieldArrange.player[t].uid),this.fieldArrange.player[t]=void 0)}load(){this.isOn&&(this.showPlaceAnimate(),this.updateField(),this.renderCard())}showPlaceAnimate(){if(this.isArranging){for(let e=0;e<this.numOfCardZone;e++){l.save(),l.globalAlpha=this.opacity.value;const t=this.fieldAxis.player[e].x,i=this.fieldAxis.player[e].y;l.drawImage(o.default.get(h),t,i),l.restore()}this.opacity.state?this.opacity.value-=.03:this.opacity.value+=.03,this.opacity.value>1?(this.opacity.value=1,this.opacity.state=!0):this.opacity.value<0&&(this.opacity.value=0,this.opacity.state=!1)}else this.opacity.state=!1,this.opacity.value=0}updateField(){const e=15;let t=0;this.canvasCardObjects.opponent.forEach((i=>{this.isLookField?i.moveTo(i.savedPos.x,this.save.opponent[t].y+y,e):i.moveTo(i.savedPos.x,this.save.opponent[t].y,e),t+=1})),t=0,this.canvasCardObjects.player.forEach((i=>{this.isLookField?i.moveTo(i.savedPos.x,this.save.player[t].y+y,e):i.moveTo(i.savedPos.x,this.save.player[t].y,e),t+=1})),this.fieldAxis.opponent.forEach(((t,i)=>{this.isLookField?(t.y>=this.save.opponent[i].y+y?this.isUpdating=!1:this.isUpdating=!0,this.isUpdating&&(t.y+=e)):(t.y<=this.save.opponent[i].y?this.isUpdating=!1:this.isUpdating=!0,this.isUpdating&&(t.y-=e))})),this.fieldAxis.player.forEach(((t,i)=>{this.isLookField?(t.y>=this.save.player[i].y+y?this.isUpdating=!1:this.isUpdating=!0,this.isUpdating&&(t.y+=e)):(t.y<=this.save.player[i].y?this.isUpdating=!1:this.isUpdating=!0,this.isUpdating&&(t.y-=e))}))}init(){return s(this,void 0,void 0,(function*(){p=o.default.get(h).width,u=o.default.get(h).height;const e=Math.floor(d.getBoundingClientRect().height*c/2-u+4),t=Math.floor(d.getBoundingClientRect().width*c/2-p*this.numOfCardZone/2+4*(this.numOfCardZone-1)/2);for(let i=0;i<2;i++)for(let s=0;s<this.numOfCardZone;s++){const a=t+(p-4)*s,n=e+(u-4)*i;0===i?(this.fieldAxis.opponent.push({x:a,y:n-y}),this.save.opponent.push({x:a,y:n-y})):(this.fieldAxis.player.push({x:a,y:n-y}),this.save.player.push({x:a,y:n-y}))}window.addEventListener("click",(e=>{const t=e.clientX,i=e.clientY;if(this.isArranging&&t&&i)for(let e=0;e<this.numOfCardZone;e++)t>this.fieldAxis.player[e].x/c&&t<(this.fieldAxis.player[e].x+p)/c&&i>=this.fieldAxis.player[e].y/c&&i<(this.fieldAxis.player[e].y+u)/c&&(this.fieldArrange.player[e]||(this.placeCard(this.selectedCard,e,this.isPlayerTurn),this.isArranging=!1,this.selectedCard=void 0));if(this.isSacrificing&&t&&i)for(let e=0;e<this.numOfCardZone;e++)t>this.fieldAxis.player[e].x/c&&t<(this.fieldAxis.player[e].x+p)/c&&i>=this.fieldAxis.player[e].y/c&&i<(this.fieldAxis.player[e].y+u)/c&&this.fieldArrange.player[e]&&(this.selectedCard.sacrifice[this.selectedSacrificeCard.length]!==this.fieldArrange.player[e].type&&0!==this.selectedCard.sacrifice[this.selectedSacrificeCard.length]||(this.selectedSacrificeCard.push(e),this.kill(1,e),this.selectedSacrificeCard.length===this.selectedCard.sacrifice.length&&(this.selectedSacrificeCard=[],this.isSacrificing=!1,this.isArranging=!0)))})),window.addEventListener("keydown",(e=>{"ArrowDown"===e.key?(this.isLookField=!0,r.CardGameUI.lookMode.isOn=!0):"ArrowUp"===e.key&&(this.isLookField=!1,r.CardGameUI.lookMode.isOn=!0)}));for(let e=0;e<this.numOfCardZone;e++)this.fieldArrange.player.push(void 0),this.fieldArrange.opponent.push(void 0)}))}}},101:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{l(s.next(e))}catch(e){n(e)}}function r(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((s=s.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasCardObject=void 0;const n=a(i(10));document.body,window.devicePixelRatio,t.CanvasCardObject=class{constructor(e,t,i,s,a){this.x=0,this.y=0,this.xSaver=0,this.ySaver=0,this.isArranged=!1,this.isAttacking=!1,this.attackMotion=!1,this.isPlayerTurn=!1,this.isMouseOver=!1,this.x3Option="",this.multiple=1,this.savedPos={x:0,y:0},this.card=e,this.isPlayerCard=t,this.x=i.x,this.y=i.y,this.theme=`${s}`,this.x3Option=a?"x3":"",this.multiple=a?3:2,this.xSaver=i.x,this.ySaver=i.y,this.save()}load(){const e=document.getElementById("canvas").getContext("2d"),t=`../public/assets/card/${this.theme}/front${this.x3Option}.png`,i=`../public/assets/monster/${this.theme}/${this.card.id}${this.x3Option}.png`,s=`../public/assets/part/type/${this.theme}/${this.card.type}${this.x3Option}.png`;e.drawImage(n.default.get(t),this.x,this.y),e.drawImage(n.default.get(s),this.x+30*this.multiple,this.y+100*this.multiple);for(let t=0;t<this.card.sacrifice.length;t++){const i=`../public/assets/part/sacrifice/${this.card.sacrifice[t]}${this.x3Option}.png`;e.drawImage(n.default.get(i),this.x+8*this.multiple+16*this.multiple*t,this.y+68*this.multiple)}if(e.drawImage(n.default.get(i),this.x,this.y),this.card.atk<10){const t=`../public/assets/part/number/${this.card.atk}${this.x3Option}.png`;e.drawImage(n.default.get(t),this.x+52*this.multiple,this.y+96*this.multiple)}else{const t=`../public/assets/part/number/${Math.floor(this.card.atk/10)}${this.x3Option}.png`,i=`../public/assets/part/number/${this.card.atk%10}${this.x3Option}.png`;e.drawImage(n.default.get(t),this.x+48*this.multiple,this.y+96*this.multiple),e.drawImage(n.default.get(i),this.x+56*this.multiple,this.y+96*this.multiple)}if(this.card.def<10){const t=`../public/assets/part/number/${this.card.def}${this.x3Option}.png`;e.drawImage(n.default.get(t),this.x+65*this.multiple,this.y+112*this.multiple)}else{const t=`../public/assets/part/number/${Math.floor(this.card.def/10)}${this.x3Option}.png`,i=`../public/assets/part/number/${this.card.def%10}${this.x3Option}.png`;e.drawImage(n.default.get(t),this.x+61*this.multiple,this.y+112*this.multiple),e.drawImage(n.default.get(i),this.x+69*this.multiple,this.y+112*this.multiple)}if(this.card.heal<10){const t=`../public/assets/part/number/${this.card.heal}${this.x3Option}.png`;e.drawImage(n.default.get(t),this.x+13*this.multiple,this.y+103*this.multiple)}else{const t=`../public/assets/part/number/${Math.floor(this.card.heal/10)}${this.x3Option}.png`,i=`../public/assets/part/number/${this.card.heal%10}${this.x3Option}.png`;e.drawImage(n.default.get(t),this.x+9*this.multiple,this.y+103*this.multiple),e.drawImage(n.default.get(i),this.x+17*this.multiple,this.y+103*this.multiple)}}save(){this.savedPos.x=this.x,this.savedPos.y=this.y}attack(e){this.isAttacking=!0,this.isPlayerTurn=e}moveTo(e,t,i){return s(this,void 0,void 0,(function*(){this.x!==e&&(this.x<e?this.x+i>e?this.x+=e-this.x:this.x+=i:this.x-i<e?this.x-=this.x-e:this.x-=i),this.y!==t&&(this.y<t?this.y+i>t?this.y+=t-this.y:this.y+=i:this.y-i<t?this.y-=this.y-t:this.y-=i)}))}rander(){this.y===this.ySaver&&(this.isArranged=!0),this.isArranged||this.moveTo(this.x,this.ySaver,80),this.isAttacking&&(this.isPlayerTurn?this.attackMotion?(this.moveTo(this.x,this.ySaver,10),this.y===this.ySaver&&(this.attackMotion=!1,this.isAttacking=!1)):(this.moveTo(this.x,this.ySaver-25,10),this.y===this.ySaver-25&&(this.attackMotion=!0)):this.attackMotion?(this.moveTo(this.x,this.ySaver,10),this.y===this.ySaver&&(this.attackMotion=!1,this.isAttacking=!1)):(this.moveTo(this.x,this.ySaver+25,10),this.y===this.ySaver+25&&(this.attackMotion=!0)))}}},153:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{l(s.next(e))}catch(e){n(e)}}function r(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((s=s.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasObject=void 0;const n=a(i(10)),o=document.getElementById("canvas").getContext("2d");t.CanvasObject=class{constructor(e,t){this.x=0,this.y=0,this.savedPos={x:0,y:0},this.isAttacking=!1,this.imagePath=e,this.x=t.x,this.y=t.y,this.save()}load(){o.drawImage(n.default.get(this.imagePath),this.x,this.y)}save(){this.savedPos.x=this.x,this.savedPos.y=this.y}moveTo(e,t,i){return s(this,void 0,void 0,(function*(){this.x!==e&&(this.x<e?this.x+i>e?this.x+=e-this.x:this.x+=i:this.x-i<e?this.x-=this.x-e:this.x-=i),this.y!==t&&(this.y<t?this.y+i>t?this.y+=t-this.y:this.y+=i:this.y-i<t?this.y-=this.y-t:this.y-=i)}))}}},10:function(e,t){var i=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{l(s.next(e))}catch(e){n(e)}}function r(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});class s{static loadAll(e){return i(this,void 0,void 0,(function*(){yield new Promise((t=>i(this,void 0,void 0,(function*(){const i=e.map(((e,t)=>new Promise((i=>{const a=new Image;a.src=e,a.addEventListener("load",(()=>{s.assets[e]=a,i(t)}))}))));s.promises=i,yield Promise.allSettled(i).then((e=>{t("done"),console.log(e)}))}))))}))}static get(e){return s.assets[e]}}s.assets={},t.default=s},826:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Wait=void 0,t.Wait=function(e){return new Promise((t=>{setTimeout((()=>{t("")}),1e3*e)}))}},768:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{l(s.next(e))}catch(e){n(e)}}function r(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Card=void 0;const a=i(826);t.Card=class{constructor(e,t){this.uid=e.uid,this.id=e.id,this.name=e.name,this.type=e.type,this.sacrifice=e.sacrifice,this.atk=e.attack,this.def=e.defence,this.heal=e.health,this.abilities=e.abilities,this.theme=t}damage(e){return s(this,void 0,void 0,(function*(){for(let t=0;t<e&&(yield(0,a.Wait)(.15/e),this.heal-=1,console.log(this.heal),!(this.heal<=0));t++);}))}}},630:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Opponent=void 0,t.Opponent=class{constructor(e){this.hand=new Map,this.deck=new Map,this.name=e}addToHand(e){this.hand.set(e.uid,e)}addToDeck(e){this.deck.set(this.deck.size,e)}removeToHand(e){this.hand.delete(e)}removeToDeck(e){this.deck.delete(e)}}},363:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0,t.Player=class{constructor(e){this.hand=new Map,this.deck=new Map,this.name=e}initHand(){this.hand.clear()}addToDeck(e){this.deck.set(e.uid,e),this.updateDeck()}removeToDeck(e){this.deck.delete(e),this.updateDeck()}removeToHand(e){this.hand.delete(e)}updateDeck(){}}},619:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{l(s.next(e))}catch(e){n(e)}}function r(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ArcFade=void 0;const a=i(826),n=document.getElementById("fog"),o=n.getContext("2d"),r=window.devicePixelRatio,l=document.body;class d{static loop(){(0!==d.speed&&d.speed>0&&!(d.radius>=(l.getBoundingClientRect().width/2+l.getBoundingClientRect().width/4)*r)||d.speed<0&&!(d.radius<=0))&&(d.radius<0&&(d.radius=0),d.radius+=d.speed,o.clearRect(0,0,l.getBoundingClientRect().width*r,l.getBoundingClientRect().height*r),o.fillStyle=d.color,o.fillRect(0,0,l.getBoundingClientRect().width*r,l.getBoundingClientRect().width*r),o.restore(),o.save(),o.globalCompositeOperation="destination-out",o.beginPath(),o.arc(l.getBoundingClientRect().width/2*r,l.getBoundingClientRect().height/2*r,d.radius,0,2*Math.PI),o.fill(),o.restore()),requestAnimationFrame(d.loop)}static init(){requestAnimationFrame(d.loop)}static in(e,t){return s(this,void 0,void 0,(function*(){this.radius=0,n.style.zIndex="10",this.speed=30*e,yield(0,a.Wait)(t),n.style.zIndex="0"}))}static out(e,t){return s(this,void 0,void 0,(function*(){this.radius=(l.getBoundingClientRect().width/2+l.getBoundingClientRect().width/4)*r,n.style.zIndex="10",this.speed=-30*e,yield(0,a.Wait)(t),n.style.zIndex="0"}))}}t.ArcFade=d,d.color="black",d.radius=(l.getBoundingClientRect().width/2+l.getBoundingClientRect().width/4)*r,d.speed=0},839:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{l(s.next(e))}catch(e){n(e)}}function r(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.OpacityFade=void 0;const a=i(826),n=document.getElementById("fog"),o=n.getContext("2d"),r=window.devicePixelRatio,l=document.body;class d{static loop(){(0!==d.speed&&d.speed>0&&!(d.opacity>=1)||d.speed<0&&!(d.opacity<=0))&&(o.clearRect(0,0,l.getBoundingClientRect().width*r,l.getBoundingClientRect().height*r),o.fillStyle=`rgba(0, 0, 0, ${d.opacity})`,o.fillRect(0,0,l.getBoundingClientRect().width*r,l.getBoundingClientRect().width*r),d.opacity<0&&(d.opacity=0),d.opacity>1&&(d.opacity=1),d.opacity+=d.speed,console.log("opa")),requestAnimationFrame(d.loop)}static init(){requestAnimationFrame(d.loop)}static in(e,t){return s(this,void 0,void 0,(function*(){this.opacity=1,n.style.zIndex="10",this.speed=-.02*e,yield(0,a.Wait)(t),n.style.zIndex="0"}))}static out(e,t){return s(this,void 0,void 0,(function*(){this.opacity=0,n.style.zIndex="10",this.speed=.02*e,yield(0,a.Wait)(t),n.style.zIndex="0"}))}}t.OpacityFade=d,d.opacity=0,d.speed=0},759:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{l(s.next(e))}catch(e){n(e)}}function r(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((s=s.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Subtitle=void 0;const n=a(i(10)),o=i(221),r=document.body,l=document.getElementById("canvas").getContext("2d"),d=window.devicePixelRatio,c={nurse:"간호사",player:"나"};class h{constructor(e){h.type=e}static load(){if(h.isOn){h.currentSubtitle=h.subtitles[h.index];const e=h.currentSubtitle.split(":")[0],t=h.currentSubtitle.split(":")[1];h.isTextFinished||(h.stringIndex!==t.length-1?(h.time+=1,2===h.time&&(h.stringIndex+=1,h.output+=t[h.stringIndex],h.time=0)):h.isTextFinished=!0);const i=n.default.get("../public/assets/subtitle/subtitleX6.png"),s=n.default.get(`../public/assets/subtitle/profiles/${e}X6.png`);l.font="bold 30px Arial",l.drawImage(i,Math.floor(r.getBoundingClientRect().width*d/2-i.width/2),Math.floor(r.getBoundingClientRect().height*d-i.height-60)),s&&l.drawImage(s,Math.floor(r.getBoundingClientRect().width*d/2-i.width/2+18),Math.floor(r.getBoundingClientRect().height*d-i.height-60+18)),l.fillText(h.output,Math.floor(r.getBoundingClientRect().width*d/2-i.width/2+258),Math.floor(r.getBoundingClientRect().height*d-i.height+96)),l.fillText(c[e],Math.floor(r.getBoundingClientRect().width*d/2-i.width/2+270),Math.floor(r.getBoundingClientRect().height*d-i.height+12))}}static on(e,t){return s(this,void 0,void 0,(function*(){t&&(h.callback=t),o.World.pause(),h.isOn=!0,h.subtitles=e}))}static off(){h.isOn=!1,o.World.start()}static next(){if(h.isTextFinished)h.index+=1,h.stringIndex=-1,h.output="",void 0!==h.subtitles[h.index]?h.currentSubtitle=h.subtitles[h.index]:(h.off(),h.index=-1,h.callback()),h.isTextFinished=!1;else{h.isTextFinished=!0;const e=h.currentSubtitle.split(":")[1];h.output=e}}}t.Subtitle=h,h.isOn=!1,h.index=0,h.callback=()=>{},h.time=0,h.stringIndex=-1,h.isTextFinished=!0,h.output=""},416:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Chapter=void 0;const s=i(221);t.Chapter=class{static change(e){s.World.currentChapter=e,e.init(),s.World.currentSpace=e.space}}},114:function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Space=void 0;const a=s(i(10)),n=document.body,o=window.devicePixelRatio,r=document.getElementById("canvas").getContext("2d");t.Space=class{constructor(e,t,i){this.linkedSpace={top:void 0,left:void 0,bottom:void 0,right:void 0},this.entities=new Map,this.background=e,t.forEach((e=>{this.entities.set(String(this.entities.size),e)})),i&&(this.linkedSpace=i)}backgroundLoad(){let e=0,t=0;const i=i=>{for(let s=e;s<Math.floor(n.getBoundingClientRect().width*o)/60;s++)r.drawImage(a.default.get(`../public/assets/world/tiles/${i.tileName}.png`),60*s,60*t),e+=1,e%Math.floor(n.getBoundingClientRect().width*o/60)==0&&(e=0,t+=1);for(let s=t;s<Math.floor(n.getBoundingClientRect().height*o)/60;s++)for(let l=e;l<Math.floor(n.getBoundingClientRect().width*o)/60;l++)r.drawImage(a.default.get(`../public/assets/world/tiles/${i.tileName}.png`),60*l,60*s),e+=1,e%Math.floor(n.getBoundingClientRect().width*o/60)==0&&(e=0,t+=1)};this.background.forEach((s=>{if(void 0===s.range)i(s);else if("number"==typeof s.range)for(let i=0;i<Number(s.range);i++)r.drawImage(a.default.get(`../public/assets/world/tiles/${s.tileName}.png`),60*e,60*t),e+=1,e%Math.floor(n.getBoundingClientRect().width*o/60)==0&&(e=0,t+=1);else if("fill-all"===s.range)i(s);else if("fill-line"===s.range)for(let i=e;i<Math.floor(n.getBoundingClientRect().width*o)/60;i++)r.drawImage(a.default.get(`../public/assets/world/tiles/${s.tileName}.png`),60*i,60*t),e+=1,e%Math.floor(n.getBoundingClientRect().width*o/60)==0&&(e=0,t+=1)}))}entitiesLoad(){const e=[];this.entities.forEach((t=>{e.push(t),e.sort(((e,t)=>e.y>t.y?1:e.y<t.y?-1:0))})),e.forEach((e=>{e.load()}))}load(){this.backgroundLoad(),this.entitiesLoad()}addEntity(e){this.entities.has(e.name)||this.entities.set(e.name,e)}init(){}}},221:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{l(s.next(e))}catch(e){n(e)}}function r(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.World=void 0;const a=i(147),n=i(638),o=i(234),r=i(759),l=i(127),d=i(477),c=i(619),h=i(9),p=[new l.Chapter0],u=document.body,y=document.getElementById("canvas").getContext("2d"),f=window.devicePixelRatio,g={w:!1,a:!1,s:!1,d:!1},v=e=>{"w"===e.key||"W"===e.key?g.w=!0:"a"===e.key||"A"===e.key?g.a=!0:"s"===e.key||"S"===e.key?g.s=!0:"d"!==e.key&&"D"!==e.key||(g.d=!0)},m=e=>{"w"!==e.key&&"W"!==e.key||(g.w=!1),"a"!==e.key&&"A"!==e.key||(g.a=!1),"s"!==e.key&&"S"!==e.key||(g.s=!1),"d"!==e.key&&"D"!==e.key||(g.d=!1)},b=e=>{var t;"e"!==e.key&&"E"!==e.key||(console.log(w.targetedEventer.x),(null===(t=w.targetedEventer)||void 0===t?void 0:t.eventAvailability)&&!w.atEvent&&(w.atEvent=!0,w.targetedEventer.eventInfo.listener()),r.Subtitle.isOn&&r.Subtitle.next())};let x=window.performance.now();class w{constructor(){w.loop=w.loop.bind(w)}static start(){w.isPause=!1}static pause(){w.isPause=!0}static movePlayer(e){const t={w:!0,a:!0,s:!0,d:!0},i=()=>{w.currentSpace.entities.forEach((e=>{let i=!0,s=!0,n=!0,r=!0;const l=w.player.x+w.player.w/2-(e.x+e.w/2),c=w.player.y+w.player.h/2+w.player.h/2/2-(e.y+e.h/2+e.h/2/2),h=w.player.w/2+e.w/2,p=w.player.h/2/2+e.h/2/2,u=w.player.y+w.player.h/2+w.player.h/2>e.y+e.h/2&&w.player.y+w.player.h/2<e.y+e.h/2+e.h/2,y=w.player.x<e.x+e.w&&w.player.x+w.player.w>e.x;w.player.x+w.player.w<=e.x&&u&&Math.abs(l)<=h&&l<0&&(r=!1),w.player.x+w.player.w>=e.x&&u&&Math.abs(l)<=h&&l>0&&(s=!1),w.player.y+w.player.h/2+w.player.h/2<=e.y+e.h/2&&y&&Math.abs(c)<=p&&c<0&&(n=!1),w.player.y+w.player.h/2+w.player.h/2>=e.y+e.h/2&&y&&Math.abs(c)<=p&&c>0&&(i=!1),t.d||(r=t.d),t.a||(s=t.a),t.s||(n=t.s),t.w||(i=t.w),(e instanceof a.Stuff||e instanceof d.Wall||e instanceof o.Npc)&&(t.w=i,t.a=s,t.s=n,t.d=r)}))},s={w:!0,a:!0,s:!0,d:!0},n=()=>{let e=!0,t=!0,i=!0,a=!0;void 0===w.currentSpace.linkedSpace.top&&w.player.y<=0&&(e=!1),void 0===w.currentSpace.linkedSpace.bottom&&w.player.y+w.player.h>=u.getBoundingClientRect().height*f&&(i=!1),void 0===w.currentSpace.linkedSpace.left&&w.player.x<=0&&(t=!1),void 0===w.currentSpace.linkedSpace.right&&w.player.x+w.player.w>=u.getBoundingClientRect().width*f&&(a=!1),s.d||(a=s.d),s.a||(t=s.a),s.s||(i=s.s),s.w||(e=s.w),s.w=e,s.a=t,s.s=i,s.d=a};if(g.w){w.player.state="back";for(let a=0;a<e;a++)i(),n(),t.w&&s.w&&(w.player.y-=1)}if(g.a){w.player.state="left";for(let a=0;a<e;a++)i(),n(),t.a&&s.a&&(w.player.x-=1)}if(g.s){w.player.state="front";for(let a=0;a<e;a++)i(),n(),t.s&&s.s&&(w.player.y+=1)}if(g.d){w.player.state="right";for(let a=0;a<e;a++)i(),n(),t.d&&s.d&&(w.player.x+=1)}}static render(){w.currentSpace.load(),r.Subtitle.load()}static loop(e){const t=1e3/60,i=e-x;if(i>=t){if(x=e-i%t,y.clearRect(0,0,window.innerWidth*f,window.innerHeight*f),!w.isOn)return;w.isPause||w.movePlayer(w.playerMoveSpeed),w.render(),w.player.y<0?w.currentSpace.linkedSpace.top&&(w.currentSpace.linkedSpace.top.linkedSpace.bottom=w.currentSpace,w.currentSpace=w.currentSpace.linkedSpace.top,w.player.y=u.getBoundingClientRect().height*f):w.player.y>u.getBoundingClientRect().height*f&&w.currentSpace.linkedSpace.bottom&&(w.currentSpace.linkedSpace.bottom.linkedSpace.top=w.currentSpace,w.currentSpace=w.currentSpace.linkedSpace.bottom,w.player.y=0),w.player.x<0?w.currentSpace.linkedSpace.left&&(w.currentSpace.linkedSpace.left.linkedSpace.right=w.currentSpace,w.currentSpace=w.currentSpace.linkedSpace.left,w.player.x=u.getBoundingClientRect().width*f):w.player.x>u.getBoundingClientRect().width*f&&w.currentSpace.linkedSpace.right&&(w.currentSpace.linkedSpace.right.linkedSpace.left=w.currentSpace,w.currentSpace=w.currentSpace.linkedSpace.right,w.player.x=0),w.currentSpace.addEntity(w.player)}requestAnimationFrame(w.loop)}static init(){w.currentChapter=p[0],w.currentChapter.init(),w.currentSpace=w.currentChapter.space}static on(){return s(this,void 0,void 0,(function*(){w.isOn||(window.addEventListener("keydown",v),window.addEventListener("keyup",m),window.addEventListener("keypress",b),yield h.CardGameEngine.end(),w.isOn=!0,requestAnimationFrame(w.loop))}))}static off(){return s(this,void 0,void 0,(function*(){w.isOn&&(yield c.ArcFade.out(1,1),window.removeEventListener("keydown",v),window.removeEventListener("keyup",m),window.removeEventListener("keypress",b),w.isOn=!1)}))}}t.World=w,w.isPause=!1,w.atEvent=!1,w.isOn=!1,w.player=new n.Player("tester",{x:850,y:Math.floor(u.getBoundingClientRect().height/2*f-60),w:60,h:120}),w.playerMoveSpeed=9},127:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Chapter0=void 0;const s=i(416),a=i(114),n=i(175),o=i(265),r=document.body,l=window.devicePixelRatio,d=[{tileName:"water",range:3},{tileName:"grass",range:"fill-line"},{tileName:"water",range:4},{tileName:"grass",range:"fill-line"},{tileName:"water",range:4},{tileName:"grass",range:"fill-line"},{tileName:"water",range:5},{tileName:"grass",range:"fill-line"},{tileName:"water",range:5},{tileName:"grass",range:"fill-line"},{tileName:"water",range:5},{tileName:"grass",range:"fill-line"},{tileName:"water",range:4},{tileName:"grass",range:"fill-line"},{tileName:"water",range:4},{tileName:"grass",range:"fill-line"},{tileName:"water",range:4},{tileName:"grass",range:"fill-line"},{tileName:"water",range:3},{tileName:"grass",range:"fill-line"},{tileName:"water",range:3},{tileName:"grass",range:"fill-line"},{tileName:"water",range:2},{tileName:"grass",range:"fill-line"},{tileName:"grass",range:"fill-all"}],c=[(0,n.bed)({x:Math.floor(r.getBoundingClientRect().width/2*l-30),y:Math.floor(r.getBoundingClientRect().height/2*l-52)})],h={top:o.topSpace};class p extends s.Chapter{constructor(){super(...arguments),this.space=new a.Space(d,c,h)}init(){}}t.Chapter0=p},265:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{l(s.next(e))}catch(e){n(e)}}function r(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.topSpace=void 0;const a=i(607),n=i(9),o=i(692),r=i(630),l=i(234),d=i(114),c=document.body,h=window.devicePixelRatio,p=new l.Npc("nurse",{x:Math.floor(c.getBoundingClientRect().width/2*h-30),y:Math.floor(c.getBoundingClientRect().height/2*h-62),w:60,h:124});p.addEventListener("talk",(()=>s(void 0,void 0,void 0,(function*(){const e=new r.Opponent("loti");n.CardGameEngine.newGame(new o.Game("test",5,{player:a.player,opponent:e})),n.CardGameEngine.select("test"),n.CardGameEngine.start()})))),t.topSpace=new d.Space([{tileName:"grass",range:"fill-all"}],[p])},952:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Entity=void 0,t.Entity=class{constructor(e,t){this.name=e,this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h}}},234:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{l(s.next(e))}catch(e){n(e)}}function r(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((s=s.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Npc=void 0;const n=a(i(10)),o=i(221),r=i(952),l=document.getElementById("canvas").getContext("2d"),d=window.devicePixelRatio;class c extends r.Entity{constructor(){super(...arguments),this.state="front",this.eventAvailability=!1,this.eventInfo={type:"",listener:()=>{}},this.xSaver=0,this.ySaver=0,this.motionsInfo={all:[],length:0,index:0,activate:!1}}eventHandler(){"talk"===this.eventInfo.type&&(Math.abs(o.World.player.x-this.x)<120&&Math.abs(o.World.player.y-this.y)<120?(this.eventAvailability=!0,o.World.targetedEventer=this,l.drawImage(n.default.get("../public/assets/world/entity/etc/E.png"),this.x+this.w/2-12,this.y-52)):this.eventAvailability=!1)}motionHandler(){if(this.motionsInfo.activate){const e=this.motionsInfo.all[this.motionsInfo.index],t=e.direction,i=e.transitionValue,s=e.time,a=Math.abs(i)/(60*s)*d,n=this.xSaver+i,o=this.ySaver+i;"x"===t?this.x!==n?this.x<n?this.x+a>n?this.x=n:this.x+=a:this.x-a<n?this.x=n:this.x-=a:(this.xSaver=this.x,this.motionsInfo.index+1!==this.motionsInfo.length?this.motionsInfo.index+=1:(this.motionsInfo.activate=!1,this.motionsInfo.callback&&this.motionsInfo.callback())):"y"===t&&(this.y!==o?this.y<o?this.y+a>o?this.y=o:this.y+=a:this.y-a<o?this.y=o:this.y-=a:(this.ySaver=this.y,this.motionsInfo.index+1!==this.motionsInfo.length?this.motionsInfo.index+=1:(this.motionsInfo.activate=!1,this.motionsInfo.callback&&this.motionsInfo.callback())))}}load(){l.drawImage(n.default.get("../public/assets/world/entity/shadow/shadow.png"),this.x,this.y+Math.floor(this.h/1.7)),l.drawImage(n.default.get(`../public/assets/world/entity/${this.name}/${this.state}.png`),this.x,this.y),this.motionHandler(),this.eventHandler()}addEventListener(e,t){this.eventInfo.type=e,this.eventInfo.listener=t}motion(e,t){return s(this,void 0,void 0,(function*(){this.motionsInfo.activate?console.error("motion is already activate!"):(this.xSaver=this.x,this.ySaver=this.y,this.motionsInfo.all=e,this.motionsInfo.length=e.length,this.motionsInfo.index=0,this.motionsInfo.activate=!0,this.motionsInfo.callback=t)}))}}t.Npc=c},638:function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0;const a=s(i(10)),n=i(952);class o extends n.Entity{constructor(){super(...arguments),this.state="front"}load(){const e=document.getElementById("canvas").getContext("2d");e.drawImage(a.default.get("../public/assets/world/entity/shadow/shadow.png"),this.x,this.y+Math.floor(this.h/1.7)),e.drawImage(a.default.get(`../public/assets/world/entity/player/${this.state}.png`),this.x,this.y)}}t.Player=o},147:function(e,t,i){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Stuff=void 0;const a=s(i(10)),n=i(952),o=document.getElementById("canvas").getContext("2d");class r extends n.Entity{constructor(e,t,i){super(e,t),this.texturePath=i,this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h}load(){o.drawImage(a.default.get(this.texturePath),this.x,this.y)}}t.Stuff=r},477:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Wall=void 0;const s=i(952),a=document.getElementById("canvas").getContext("2d");class n extends s.Entity{load(){a.fillStyle="#000",a.fillRect(this.x,this.y,this.w,this.h)}}t.Wall=n},175:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bed=void 0;const s=i(147);t.bed=e=>new s.Stuff("bed",{x:e.x,y:e.y,w:60,h:104},"../public/assets/world/entity/bed/front.png")},177:e=>{e.exports=JSON.parse('{"bird":{"id":"bird","name":"새","type":1,"sacrifice":[],"attack":1,"defence":1,"health":1,"abilities":{"passive":{"id":"none","name":"","desc":""},"active":{"id":"flyAttack","name":"날아올라","desc":"필드에 상관없이 상대방에게 직접공격을 한다."}}}}')},635:e=>{e.exports=JSON.parse('{"fish":{"id":"fish","name":"활어","type":3,"sacrifice":[],"attack":0,"defence":1,"health":2,"abilities":{"passive":{"id":"none","name":"","desc":""},"active":{"id":"none","name":"","desc":""}}}}')},495:e=>{e.exports=JSON.parse('{"shark":{"id":"shark","name":"상어","type":3,"sacrifice":[3,3,3],"attack":5,"defence":3,"health":5,"abilities":{"passive":{"id":"none","name":"","desc":""},"active":{"id":"none","name":"","desc":""}}}}')},924:e=>{e.exports=JSON.parse('{"test":{"id":"bird","name":"테스트","type":1,"sacrifice":[0,0,0,0],"attack":99,"defence":99,"health":99,"abilities":{"passive":{"id":"none","name":"","desc":""},"active":{"id":"none","name":"","desc":""}}}}')}},t={};!function i(s){var a=t[s];if(void 0!==a)return a.exports;var n=t[s]={exports:{}};return e[s].call(n.exports,n,n.exports,i),n.exports}(607)})();