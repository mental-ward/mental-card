(()=>{"use strict";var e={607:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,s){function r(e){try{c(i.next(e))}catch(e){s(e)}}function o(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}c((i=i.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.player=void 0;const s=n(768),r=n(363),o=n(630),c=a(n(10)),l=n(177),d=n(635),p=n(495),u=n(221),h=document.getElementById("canvas"),y=window.devicePixelRatio;h.style.width=`${window.innerWidth}px`,h.style.height=`${window.innerHeight}px`,h.width=window.innerWidth*y,h.height=window.innerHeight*y,t.player=new r.Player("tester"),new o.Opponent("loti"),t.player.addToDeck(new s.Card(Object.assign({cardID:t.player.deck.size},d.fish))),t.player.addToDeck(new s.Card(Object.assign({cardID:t.player.deck.size},d.fish))),t.player.addToDeck(new s.Card(Object.assign({cardID:t.player.deck.size},d.fish))),t.player.addToDeck(new s.Card(Object.assign({cardID:t.player.deck.size},l.bird))),t.player.addToDeck(new s.Card(Object.assign({cardID:t.player.deck.size},p.shark))),c.default.loadAll(["../public/assets/part/type/1.png","../public/assets/part/type/2.png","../public/assets/part/type/3.png","../public/assets/card-zone.png","../public/assets/card/front.png","../public/assets/monster/human.png","../public/assets/monster/bird.png","../public/assets/monster/turtle.png","../public/assets/monster/forestGuardian.png","../public/assets/monster/shark.png","../public/assets/monster/fish.png","../public/assets/world/entity/player/back.png","../public/assets/world/entity/player/front.png","../public/assets/world/entity/player/left.png","../public/assets/world/entity/player/right.png","../public/assets/world/bg/space1/1.png","../public/assets/world/entity/etc/E.png","../public/assets/subtitle/profiles/nurseX6.png","../public/assets/subtitle/profiles/playerX6.png","../public/assets/subtitle/subtitle.png","../public/assets/subtitle/subtitleX6.png","../public/assets/world/entity/bed/front.png","../public/assets/world/entity/nurse/front.png","../public/assets/part/abilities/double-attack.png","../public/assets/part/sacrifice/0.png","../public/assets/part/sacrifice/1.png","../public/assets/part/sacrifice/2.png","../public/assets/part/sacrifice/3.png","../public/assets/part/number/0.png","../public/assets/part/number/1.png","../public/assets/part/number/2.png","../public/assets/part/number/3.png","../public/assets/part/number/4.png","../public/assets/part/number/5.png","../public/assets/part/number/6.png","../public/assets/part/number/7.png","../public/assets/part/number/8.png","../public/assets/part/number/9.png"]).then((()=>i(void 0,void 0,void 0,(function*(){u.World.init(),u.World.on()}))))},10:function(e,t){var n=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,s){function r(e){try{c(i.next(e))}catch(e){s(e)}}function o(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});class i{static loadAll(e){return n(this,void 0,void 0,(function*(){yield new Promise((t=>n(this,void 0,void 0,(function*(){const n=e.map(((e,t)=>new Promise((n=>{const a=new Image;a.src=e,a.addEventListener("load",(()=>{i.assets[e]=a,n(t)}))}))));i.promises=n,yield Promise.allSettled(n).then((e=>{t("done"),console.log(e)}))}))))}))}static get(e){return i.assets[e]}}i.assets={},t.default=i},826:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Wait=void 0,t.Wait=function(e){return new Promise((t=>{setTimeout((()=>{t("")}),1e3*e)}))}},768:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,s){function r(e){try{c(i.next(e))}catch(e){s(e)}}function o(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Card=void 0;const a=n(826);t.Card=class{constructor(e){this.cardID=e.cardID,this.name=e.name,this.type=e.type,this.sacrifice=e.sacrifice,this.atk=e.attack,this.def=e.defence,this.heal=e.health,this.abilities=e.abilities}damage(e){return i(this,void 0,void 0,(function*(){for(let t=0;t<e&&(yield(0,a.Wait)(.15/e),this.heal-=1,console.log(this.heal),!(this.heal<=0));t++);}))}}},630:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Opponent=void 0,t.Opponent=class{constructor(e){this.hand=new Map,this.deck=new Map,this.name=e}addToHand(e){this.hand.set(e.cardID,e)}addToDeck(e){this.deck.set(this.deck.size,e)}removeToHand(e){this.hand.delete(e)}removeToDeck(e){this.deck.delete(e)}}},363:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0,t.Player=class{constructor(e){this.hand=new Map,this.deck=new Map,this.name=e}initHand(){this.hand.clear()}addToDeck(e){this.deck.set(e.cardID,e),this.updateDeck()}removeToDeck(e){this.deck.delete(e),this.updateDeck()}removeToHand(e){this.hand.delete(e)}updateDeck(){const e=document.getElementById("player-deck");e.replaceChildren(),this.deck.forEach(((t,n)=>{const i=document.createElement("img");i.src="./assets/card/back.png",i.alt=t.name,i.classList.add("card"),i.style.right=5*n+20+"px",e.append(i)}))}}},25:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,s){function r(e){try{c(i.next(e))}catch(e){s(e)}}function o(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Scenario=void 0;const a=n(826),s=n(221),r=document.getElementById("bell"),o=document.getElementById("player-container"),c=document.getElementById("card-info"),l=document.getElementById("scenario-container"),d=document.body;class p{static on(){return i(this,void 0,void 0,(function*(){this.isScenarioOn||(console.log(s.World),l.classList.remove("hidden"),yield(0,a.Wait)(.1),r.style.transform=`translate(0px, ${d.getBoundingClientRect().height/100*40+90}px)`,o.style.transform=`translate(0px, ${d.getBoundingClientRect().height/100*40}px)`,c.style.transform="translate(500px, 0px)",yield(0,a.Wait)(.1),l.classList.remove("scenario-off"),l.classList.add("scenario-on"),this.isScenarioOn=!0)}))}static off(){return i(this,void 0,void 0,(function*(){this.isScenarioOn&&(l.classList.add("scenario-off"),l.classList.remove("scenario-on"),yield(0,a.Wait)(.1),r.style.transform="translate(0px, 90px)",o.style.transform="translate(0px, 0px)",yield(0,a.Wait)(.1),l.classList.add("hidden"),this.isScenarioOn=!1)}))}}t.Scenario=p,p.isScenarioOn=!1},759:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,s){function r(e){try{c(i.next(e))}catch(e){s(e)}}function o(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}c((i=i.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Subtitle=void 0;const s=a(n(10)),r=n(221),o=document.body,c=document.getElementById("canvas").getContext("2d"),l=window.devicePixelRatio,d={nurse:"간호사",player:"나"};class p{constructor(e){p.type=e}static load(){if(p.isOn){p.currentSubtitle=p.subtitles[p.index];const e=p.currentSubtitle.split(":")[0],t=p.currentSubtitle.split(":")[1];p.isTextFinished||(p.stringIndex!==t.length-1?(p.time+=1,2===p.time&&(p.stringIndex+=1,p.output+=t[p.stringIndex],p.time=0)):p.isTextFinished=!0);const n=s.default.get("../public/assets/subtitle/subtitleX6.png"),i=s.default.get(`../public/assets/subtitle/profiles/${e}X6.png`);c.font="bold 30px Arial",c.drawImage(n,Math.floor(o.getBoundingClientRect().width*l/2-n.width/2),Math.floor(o.getBoundingClientRect().height*l-n.height-60)),i&&c.drawImage(i,Math.floor(o.getBoundingClientRect().width*l/2-n.width/2+18),Math.floor(o.getBoundingClientRect().height*l-n.height-60+18)),c.fillText(p.output,Math.floor(o.getBoundingClientRect().width*l/2-n.width/2+258),Math.floor(o.getBoundingClientRect().height*l-n.height+96)),c.fillText(d[e],Math.floor(o.getBoundingClientRect().width*l/2-n.width/2+270),Math.floor(o.getBoundingClientRect().height*l-n.height+12))}}static on(e,t){return i(this,void 0,void 0,(function*(){t&&(p.callback=t),r.World.pause(),p.isOn=!0,p.subtitles=e}))}static off(){p.isOn=!1,r.World.start()}static next(){if(p.isTextFinished)p.index+=1,p.stringIndex=-1,p.output="",void 0!==p.subtitles[p.index]?p.currentSubtitle=p.subtitles[p.index]:(p.off(),p.index=-1,p.callback()),p.isTextFinished=!1;else{p.isTextFinished=!0;const e=p.currentSubtitle.split(":")[1];p.output=e}}}t.Subtitle=p,p.isOn=!1,p.index=0,p.callback=()=>{},p.time=0,p.stringIndex=-1,p.isTextFinished=!0,p.output=""},114:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Space=void 0,document.body,window.devicePixelRatio,document.getElementById("canvas").getContext("2d"),t.Space=class{constructor(e,t,n){this.linkedSpace={top:void 0,left:void 0,bottom:void 0,right:void 0},this.entities=new Map,this.backgroundImagePath=e,t.forEach((e=>{this.entities.set(this.entities.size,e)})),n&&(this.linkedSpace=n)}load(){this.entities.forEach((e=>{e.load()}))}init(){}}},221:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.World=void 0;const i=n(147),a=n(638),s=n(759),r=n(924),o=document.body,c=document.getElementById("bell"),l=document.getElementById("player-container"),d=document.getElementById("card-info"),p=document.getElementById("canvas").getContext("2d"),u=window.devicePixelRatio,h={w:!1,a:!1,s:!1,d:!1},y=e=>{"w"===e.key||"W"===e.key?h.w=!0:"a"===e.key||"A"===e.key?h.a=!0:"s"===e.key||"S"===e.key?h.s=!0:"d"!==e.key&&"D"!==e.key||(h.d=!0)},f=e=>{"w"!==e.key&&"W"!==e.key||(h.w=!1),"a"!==e.key&&"A"!==e.key||(h.a=!1),"s"!==e.key&&"S"!==e.key||(h.s=!1),"d"!==e.key&&"D"!==e.key||(h.d=!1)},g=e=>{"e"!==e.key&&"E"!==e.key||(w.targetedEventer.eventAvailability&&!w.atEvent&&(w.atEvent=!0,w.targetedEventer.event()),s.Subtitle.isOn&&s.Subtitle.next())};let b=window.performance.now();class w{constructor(){w.loop=w.loop.bind(w)}static start(){w.isPause=!1}static pause(){w.isPause=!0}static movePlayer(e){const t={w:!0,a:!0,s:!0,d:!0},n=()=>{w.currentSpace.entities.forEach((e=>{i.Stuff;let n=!0,a=!0,s=!0,r=!0;const o=w.player.x+w.player.w/2-(e.x+e.w/2),c=w.player.y+w.player.h/2-(e.y+e.h/2),l=w.player.w/2+e.w/2,d=w.player.h/2+e.h/2;w.player.x+w.player.w<=e.x&&w.player.y+w.player.h>e.y&&w.player.y<e.y+e.h&&Math.abs(o)<=l&&o<0&&(r=!1),w.player.x+w.player.w>=e.x&&w.player.y+w.player.h>e.y&&w.player.y<e.y+e.h&&Math.abs(o)<=l&&o>0&&(a=!1),w.player.y+w.player.h<=e.y&&w.player.x<e.x+e.w&&w.player.x+w.player.w>e.x&&Math.abs(c)<=d&&c<0&&(s=!1),w.player.y+w.player.h>=e.y&&w.player.x<e.x+e.w&&w.player.x+w.player.w>e.x&&Math.abs(c)<=d&&c>0&&(n=!1),t.d||(r=t.d),t.a||(a=t.a),t.s||(s=t.s),t.w||(n=t.w),t.w=n,t.a=a,t.s=s,t.d=r}))};if(h.w){w.player.state="back";for(let i=0;i<e;i++)n(),t.w&&(w.player.y-=1)}if(h.a){w.player.state="left";for(let i=0;i<e;i++)n(),t.a&&(w.player.x-=1)}if(h.s){w.player.state="front";for(let i=0;i<e;i++)n(),t.s&&(w.player.y+=1)}if(h.d){w.player.state="right";for(let i=0;i<e;i++)n(),t.d&&(w.player.x+=1)}}static render(){w.currentSpace.load(),w.player.load(),s.Subtitle.load()}static loop(e){const t=1e3/60,n=e-b;if(n>=t){if(b=e-n%t,p.clearRect(0,0,window.innerWidth*u,window.innerHeight*u),!w.isOn)return;w.isPause||w.movePlayer(10),w.render(),w.player.y<0?(w.currentSpace.linkedSpace.top&&(w.currentSpace.linkedSpace.top.linkedSpace.bottom=w.currentSpace,w.currentSpace=w.currentSpace.linkedSpace.top),w.player.y=o.getBoundingClientRect().height*u):w.player.y>o.getBoundingClientRect().height*u&&(w.currentSpace.linkedSpace.bottom&&(w.currentSpace.linkedSpace.bottom.linkedSpace.top=w.currentSpace,w.currentSpace=w.currentSpace.linkedSpace.bottom),w.player.y=0),w.player.x<0?(w.currentSpace.linkedSpace.left&&(w.currentSpace.linkedSpace.left.linkedSpace.right=w.currentSpace,w.currentSpace=w.currentSpace.linkedSpace.left),w.player.x=o.getBoundingClientRect().width*u):w.player.x>o.getBoundingClientRect().width*u&&(w.currentSpace.linkedSpace.right&&(w.currentSpace.linkedSpace.right.linkedSpace.left=w.currentSpace,w.currentSpace=w.currentSpace.linkedSpace.right),w.player.x=0)}requestAnimationFrame(w.loop)}static init(){w.currentSpace=r.space0}static on(){window.addEventListener("keydown",y),window.addEventListener("keyup",f),window.addEventListener("keypress",g),c.classList.add("bell-hidden"),l.style.transform=`translate(0px, ${o.getBoundingClientRect().height/100*40}px)`,d.style.transform="translate(500px, 0px)",w.isOn=!0,requestAnimationFrame(w.loop)}static off(){window.removeEventListener("keydown",y),window.removeEventListener("keyup",f),window.removeEventListener("keypress",g),c.classList.remove("bell-hidden"),l.style.transform="translate(0px, 0px)",d.style.transform="translate(0px, 0px)",w.isOn=!1}}t.World=w,w.isPause=!1,w.atEvent=!1,w.isOn=!1,w.player=new a.Player("tester",{x:850,y:Math.floor(o.getBoundingClientRect().height/2*u-60),w:60,h:120})},952:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Entity=void 0,t.Entity=class{constructor(e,t){this.name=e,this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h,this.w=60,this.h=120}}},234:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Npc=void 0;const a=i(n(10)),s=n(221),r=n(952),o=document.getElementById("canvas").getContext("2d");class c extends r.Entity{constructor(){super(...arguments),this.state="front",this.eventAvailability=!1,this.eventType="",this.event=()=>{}}load(){o.drawImage(a.default.get(`../public/assets/world/entity/${this.name}/${this.state}.png`),this.x,this.y),"talk"===this.eventType&&(Math.abs(s.World.player.x-this.x)<120&&Math.abs(s.World.player.y-this.y)<120?(this.eventAvailability=!0,s.World.targetedEventer=this,o.drawImage(a.default.get("../public/assets/world/entity/etc/E.png"),this.x+this.w/2-12,this.y-52)):this.eventAvailability=!1)}addEvent(e,t){this.eventType=e,this.event=t}moveTo(){}}t.Npc=c},638:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0;const a=i(n(10)),s=n(952);class r extends s.Entity{constructor(){super(...arguments),this.state="front"}load(){document.getElementById("canvas").getContext("2d").drawImage(a.default.get(`../public/assets/world/entity/player/${this.state}.png`),this.x,this.y)}}t.Player=r},147:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Stuff=void 0;const a=i(n(10)),s=n(952),r=document.getElementById("canvas").getContext("2d");class o extends s.Entity{constructor(e,t,n){super(e,t),this.texturePath=n,this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h}load(){r.drawImage(a.default.get(this.texturePath),this.x,this.y)}}t.Stuff=o},774:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bed=void 0;const i=n(147);t.bed=e=>new i.Stuff("bed",{x:e.x,y:e.y,w:60,h:104},"../public/assets/world/entity/bed/front.png")},924:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.space0=void 0;const i=n(25),a=n(114),s=n(234),r=n(774),o=document.body,c=window.devicePixelRatio,l=new s.Npc("nurse",{x:500,y:Math.floor(o.getBoundingClientRect().height/2*c-62),w:60,h:124});i.Scenario.on(),t.space0=new a.Space("../public/assets/world/bg/space1/1.png",[(0,r.bed)({x:Math.floor(o.getBoundingClientRect().width/2*c-30),y:Math.floor(o.getBoundingClientRect().height/2*c-52)}),l],{top:new a.Space("../public/assets/world/bg/space1/1.png",[])})},177:e=>{e.exports=JSON.parse('{"bird":{"name":"bird","type":1,"sacrifice":[],"attack":5,"defence":1,"health":1,"abilities":""}}')},635:e=>{e.exports=JSON.parse('{"fish":{"name":"fish","type":3,"sacrifice":[],"attack":0,"defence":1,"health":2,"abilities":""}}')},495:e=>{e.exports=JSON.parse('{"shark":{"name":"shark","type":3,"sacrifice":[3,3,3],"attack":5,"defence":3,"health":5,"abilities":""}}')}},t={};!function n(i){var a=t[i];if(void 0!==a)return a.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,n),s.exports}(607)})();